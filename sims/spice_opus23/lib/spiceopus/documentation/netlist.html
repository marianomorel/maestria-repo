<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <meta name="description" content="SPICE OPUS -- A SPICE engine for OPtimization UtilitieS" />
  <meta name="keywords" content="analog circuit simulation, spice, opus, analog circuit optimization" />
  <meta name="author" content="Faculty of Electircal Engineering, Ljubljana, Slovenia / Template design: G. Wolfgang" />
  <link rel="stylesheet" type="text/css" media="screen,projection" href="./css/style_screen.css" />
  <link rel="stylesheet" type="text/css" media="print" href="./css/style_print.css" />
  <title>SPICE OPUS</title>
</head>

<body>
<div class="bg-head"><div class="page-container-2">

     <!-- Navigation Level 1 -->
     <div class="nav1-container">
    	<div class="nav1">
			<ul>
    	    	<li><a href="index.html">Home</a></li>
         		<li><a href="contact.html">Contact</a></li>																		
			</ul>
		</div>
    </div>			
		<a href="index.html"><div class="site-name"></div></a>
    
    <!-- Site slogan -->
	  <div class="site-slogan-container">
		<div class="site-slogan">
       		<p class="readmore">&rsaquo;&rsaquo;&rsaquo;&nbsp;<a href="img/screen-pll.png">Screenshot</a></p>
    		<p class="title">THE SLIDE RULE OF SILICON DESIGN</p>
	      	<p class="subtitle">Free Analog Circuit Simulation</p>  
    	</div>
	  </div>		 						    	
       	 						
    <!-- Header banner -->		 						    		 						
	  <div class="img-header"></div>
    
    <!-- Navigation Level 2 -->												
    <div class="nav2">			
			<ul>
        <li><a href="index.html">About</a></li>
        <li><a href="license.html">License</a></li>
        <li><a href="release.html">Release</a></li>
        <li><a href="http://www.spiceopus.si/download/download.html">Download</a></li>			
        <li><a href="documentation.html"class="selected">Documentation</a></li>		
        <li><a href="links.html">Links</a></li>
		  </ul>
		</div>
    
    <!-- Buffer after header -->    
		<div class="buffer"></div>

		<!-- NAVIGATION -->				
  	<!-- Navigation Level 3 -->
		<div class="nav3">
      <ul>
        <li class="title">Menu</li>
        <li class="group"><a href="index.html">About</a></li>		
        <li class="group"><a href="license.html">License</a></li>
        <li class="group"><a href="release.html">Release</a></li>
        <li class="group"><a href="http://www.spiceopus.si/download/download.html">Download</a></li>       
           <li><a href="http://www.spiceopus.si/download/downloadl.html">Linux</a></li>
           <li><a href="http://www.spiceopus.si/download/downloadw.html">Windows</a></li>
        <li class="group"><a href="documentation.html"class="selected">Documentation</a></li>
        <li class="group"><a href="links.html">Links</a></li>       
      </ul>
    </div>				

  	<!-- 	CONTENT -->
		<div class="content2">

  	  <!-- Page title -->		
		  <div class="content2-pagetitle">Netlist Syntax</div>			
       
      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="nb1"></a>
					SpiceOpus, Berkeley SPICE and XSPICE
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          The original Berkeley netlist syntax for devices and models is kept throughout SpiceOpus except in the following cases:
          <ul class="noindent">
          <li>XSPICE A devices and XSPICE .MODEL cards
          <li>Berkeley SPICE2 style POLY sources are supported, but not recommended. Use SPICE3 style B sources instead.
          <li>Many extensions have been made. To find out more, read this document.
          </ul>
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
				  <a name="nb2"></a>
          Dividing a circuit netlist among multiple files (.include and .lib)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          In many cases it is practical to divide a large netlist among multiple files. SpiceOpus provides two means for 
          accomplishning this: .include and .lib netlist directives. Both of them are preprocessor directvies 
          and include an external file or a part of an external file in the netlist that is parsed. .include and .lib 
          can be used throughout the whole netlist (not just outside, but inside .SUBCKT and .CONTROL blocks also). 
          Note that these are preprocessor directives and merely include a text from other files.
          <p class="content-title-noshade-size2">.include<p>
          Syntax:
          <p class="showcode">.include filename
          <p>or
          <p class="showcode">.include path/filename
          <p>Includes a file.
          <p class="content-title-noshade-size2">.lib<p>
          Syntax:
          <p class="showcode">.lib 'filename' section
          <p>or
          <p class="showcode">.lib 'path/filename' section
          <p>Includes a file section. A file section can be specified in the following manner:
          <p class="showcode">.lib section<br>
          ...<br>
          * stuff to include<br>
          ...<br>
          .ENDL
          <p>Both .include and .lib can go as deep as you want. Recursion is not allowed and in case it happens an 
          error message is produced when a netlist is being loaded. Don't forget to surround the filename with single 
          quotes. Use '/' as the path separator in Windows and in Unix although '\' also works for Windows.
          <p class="content-title-noshade-size2">How SpiceOpus searches for .include and .lib files?<p>
          In case the file is specified with its full or partial path, use '/' instead of '\' in Windows. This will make your 
          netlists more portable. In case you use '/' in Windows they will get converted to '\' automatically. For specifying a 
          drive in Windows use the same syntax as in Dos (e.g. 'c:'). We recommend against using a drive specification since this 
          makes you netlists less portable to Unix.
          <p>A file is first searched in the current directory if it is specified as a filename. If you specify a relative 
          path, the first path tried is relative to the current directory. To see the current working directory, use the Nutmeg command:
          <p class="showcode">echo $(workdir)
          <p>or
          <p class="showcode">cd .
          <p>To change to your home directory (Unix only) type:
          <p class="showcode">cd
          <p>To change your working directory type:
          <p class="showcode">cd directory
          <p>If the file is not found it is looked up relative to the directories specified in the sourcepath variable. 
          To set the sourcepath type (usually in the spinit file):
          <p class="showcode">* This will add path1, ... to the sourcepath
          set sourcepath=( $(sourcepath) path1 path2 ... )<br>
          * This will set sourcepath to path1, ...<br>
          set sourcepath=( path1 path2 ... )<br>
          * Don't forget to add a space after '(' and before ')'.<br>
          <p>Default sourcepath is set to:
          <p class="showcode">. &lt;lib/scripts directory&gt;
          <p>This means that the files are looked up in the current directory and in then in the lib/scripts directory 
          where SpiceOpus is installed. Finally if the file is still not found, the file is looked up relative to the directory 
          where the file, from where the .include or .lib call was made, resides.
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
				  <a name="nb3"></a>
          Netclasses (.netclass) (v2.1)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          In many cases one requires multiple different descriptions for the same part of the circuit. 
          One such case is the cornerpoint analysis in chip design where designers have different models 
          for different extreme conditions that can occur at chip fabrication (like typical mean, worst 
          one, worst zero,worst power, etc.).
          <p>Another use is in failure mode analysis (FMA) where a circuit (usually comprising 
          discrete components) is simulated for various failure modes (e.g. Q1 short between C and 
          B, Q1 short between B and E, Q1 open at C, ...).
          <p class="content-title-noshade-size2">Defining a netclass (.NETCLASS, .ENDN)<p>
          To define a section of netlist that describes a particular operating condition use:
          <p class="showcode">.NETCLASS classname classkey<br>
          ...<br>
          condition description<br>
          ...<br>
          .ENDN<br>
          <p class="content-title-noshade-size2">Using .NETCLASS for defining corner points<p>
          Let's define 4 netclasses from class chiptype and name them tm, wo, wz and wp. Each of them will 
          describe the respective NMOS and PMOS models:
          <p class="showcode">.NETCLASS chiptype tm<br>
          .model nmosmod nmos LEVEL=... &lt;typical mean model parameters&gt;<br>
          .model pmosmod pmos LEVEL=... &lt;typical mean model parameters&gt;<br>
          .ENDN<br><br>
          .NETCLASS chiptype wo<br>
          .model nmosmod nmos LEVEL=... &lt;worst one model parameters&gt;<br>
          .model pmosmod pmos LEVEL=... &lt;worst one model parameters&gt;<br>
          .ENDN<br><br>
          .NETCLASS chiptype wz<br>
          .model nmosmod nmos LEVEL=... &lt;worst zero model parameters&gt;<br>
          .model pmosmod pmos LEVEL=... &lt;worst zero model parameters&gt;<br>
          .ENDN<br><br>
          .NETCLASS chiptype wp<br>
          .model nmosmod nmos LEVEL=... &lt;worst power model parameters&gt;<br>
          .model pmosmod pmos LEVEL=... &lt;worst power model parameters&gt;<br>
          .ENDN<br> 
          <p>Chip fabrication facilities usually provide designers with such models for 
          NMOS, PMOS, diffusions, etc. Of course you don't have to copy .MODEL cards from other files. 
          You can simply .include or .lib them into a .NETCLASS block.
          <p class="content-title-noshade-size2">Using .NETCLASS for defining failure modes<p>
          Let's define 6 netclasses, 3 from the class criticalc and 3 from the class criticalq:
          <p class="showcode">* Capacitor C1 normal operation<br>
          .NETCLASS criticalc normal<br>
          c1 1 2 10u<br>
          .ENDN<br><br>
          * Capacitor C1 shorted<br>
          .NETCLASS criticalc short<br>
          c1 1 2 10u<br>
          rc1p 1 2 1m<br>
          .ENDN<br><br>
          * Capacitor C1 open<br>
          .NETCLASS criticalc open<br>
          c1 1 int2 10u<br>
          rc1s int2 2 1G<br>
          .ENDN<br><br>
          * BJT Q1 normal operation<br>
          .NETCLASS criticalq normal<br>
          q1 10 20 30 q2n2222<br>
          .ENDN<br><br>
          * BJT Q1 open colector<br>
          .NETCLASS criticalq openc<br>
          q1 int10 20 30 q2n2222<br>
          rq1s int10 10 1G<br>
          .ENDN<br><br>
          * BJT Q1 shorted B-E<br>
          .NETCLASS criticalq shortbe<br>
          q1 10 20 30 q2n2222<br>
          rq1p 20 30 1m<br>
          .ENDN<br>
          <p class="content-title-noshade-size2">Netclass and key enumeration, default netclasses<p>
          Netclass names are automatically enumerated in the same order as they are found in the netlist, 
          starting from 0. Keys for a particular netclass are also automatically enumerated in the same 
          order as they are found in the netlist starting from 0. In the above described case of failure 
          modes, the enumeration is as follows:
          <p class="showcode">criticalc 0<br>
          normal 0<br>
          short  1<br>
          open   2<br><br>
          criticalq 1<br>
          normal  0<br>
          openc   1<br>
          shortbe 2<br>
          <p>Default key for every netclass is the one enumerated with 0. This is the key that is first 
          defined for a particular netclass. It is recommended to define as the first key the normal 
          operating conditions. In case multiple .NETCLASS blocks with the same netclass name and key name are defined 
          they are treated as members of the same netclass::key combination. The default netclass key is the one 
          that is active when the control block is started. If you would simulate the FMA example described above 
          the normal key would be used for the criticalc netclass and the normal key would be used for the criticalq 
          netclass. In fact you would simulate normal operating conditions for C1 and Q1.
          <p class="content-title-noshade-size2">
          <A NAME=nb3_selecting></a>Selecting a netclass key from Nutmeg<p>
          To select a particular key for a particular netclass, use:
          <p class="showcode">netclass select &lt;netclass name&gt;::&lt;key name&gt;<br>
          * These three are also possible<br>
          netclass select &lt;netclass number&gt;::&lt;key name&gt;<br>
          netclass select &lt;netclass name&gt;::&lt;key number&gt;<br>
          netclass select &lt;netclass number&gt;::&lt;key number&gt;<br>
          <p>Changes in active keys, if there are any, will take effect after you call:
          <p class="showcode">netclass rebuild
          <p>If there were no changes (active keys are the same as currently parsed ones) then netclass rebuild 
          command will be ignored and circuit not reparsed. To force reparsing regardless key matching use 
          forcerebuild variable. If the variable is set then reparsing is always performed. The information about 
          key matching can also be retrieved by:
          <p class="showcode">netclass uptodate &lt;scalar&gt;
          <p>Value of scalar is set to one if circuit update is needed. That means that active keys are 
          not the same as currently parsed ones and circuit reparsing or rebuilding should take place. 
          Otherwise <scalar> is set to zero and circuit update is not needed. Circuit reparsing will also 
          reset all instance parameter values to the ones specified in active netclass descriptions. In 
          case you call a netclass rebuild this during an optimize analysis and the command is not ignored, 
          call also:
          <p class="showcode">optimize setparams
          <p>The command properly set all instance parameters mathematically linked to optimisation 
          parameters with let commands. Example:
          <p class="showcode">optimize analysis ...<br>
          optimize analysis 100 netclass uptodate reparse<br>
          optimize analysis 110 if reparse<br>
          optimize analysis 120 netclass rebuild<br>
          optimize analysis 130 optimize setparams<br>
          optimize analysis 140 end<br>
          optimize analysis 150 unlet reparse<br>
          optimize analysis ...<br>
          <p>To reset all netclass keys to default keys (number zero keys), call:
          <p class="showcode">netclass reset
          <p>Changes will again take effect after you call netclass rebuild.
          Some examples:
          <p class="showcode">* Simulate normal operation for C1 and short B-E for Q1<br>
          netclass select criticalc::normal<br>
          netclass select criticalq::shortbe<br>
          netclass rebuild<br>
          * Simulation/analysis commands follow<br><br>
          * Simulate a short in C1 and short B-E for Q1<br>
          netclass select criticalc::short<br>
          netclass select criticalq::shortbe<br>
          netclass rebuild<br>
          * Simulation/analysis commands follow<br><br>
          * This is also possible<br>
          netclass select 0::1<br>
          netclass select 1::2<br>
          netclass rebuild<br><br>
          * To select worst one conditions for a chip simulation<br>
          netclass select chiptype::wo<br>
          netclass rebuild<br>
          <p class="content-title-noshade-size2">Displaying netclasses<p>
          To display a list of all netclasses type:
          <p class="showcode">listing nc
          <p>This lists all netclasses and all keys. It also marks the active keys and 
          warns you if the netlists needs a netclass rebuild. To display a list of active 
          netclass keys for all netclasses type:
          <p class="showcode">listing activenc
          <p>To get information on selected netclasses type:
          <p class="showcode">listing nc netclass1 netclass2 ...
          <p>In case the circuit needs a netclass rebuild (active keys have changed
          since the last netclass rebuild call), a waring is printed. 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
				  <a name="1"></a>
          Important Note Regarding Name Expansion In Subcircuits
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          SpiceOpus uses the XSPICE style subcircuit name expansion (which is more logical than 
          Berkeley style). Nutmeg scripts that access elements/models in subcircuits won't work 
          if they are written for the Berkeley SPICE.
          Read the sections below to learn more about XSPICE style of subcircuit name expansion. 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="2"></a>
          A Quick Guide To Subcircuits
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          A subcircuit can be declared using the following syntax:
          <p class="showcode">.subckt subckt_name node1 node2 node3 ...<br>
          subckt netlist<br>
          .ends<br>
          <p>Nodes node1, node2, ... are the interface to the outside world. Node 0 inside a subcircuit 
          has the same meaning as everywhere else in the circuit (ground node). A subcircuit can 
          be used in your netlist:
          <p class="showcode">x1 node1 node2 node3 ... subckt_name
          <p>The above statement puts subcircuit named subckt_name as subcircuit instance x1 in your circuit 
          and connects it to nodes node1, node2, node3, ... Let's take a look at an example:
          <p class="showcode">.subckt attenuator in out comm<br>
          r1 in int 16.67 rmod1<br>
          r2 int out 16.67 rmod1<br>
          r3 int comm 66.67 rmod1<br>
          .model rmod1 r tc1=0.001 tc2=0.0001<br>
          .ends<br>
          <p>The subcircuit defined above is a 6dB attenuator with temperature dependence caused 
          by the temperature dependence of resistors (see resistor model rmod1). Model rmod1, devices 
          r1, r2 and r3 and node names in, out, comm and int are valid only inside this subcircuit. 
          You can reuse these names somewhere else in the netlist without worrying about name conflicts.
          In order to use this subcircuit in a netlist the x element must be used:
          <p class="showcode">xexample1 6 7 0 attenuator
          <p>This places subcircuit attenuator as subcircuit instance xexample1 in your circuit and connects 
          nodes in, out and comm of the subcircuit to nodes 6, 7 and 0 of the circuit. Subcircuits can be 
          used also in higher level subcircuits. As an example let's build a 12dB attenuator from 
          two 6dB attenuators:
          <p class="showcode">.subckt bigatten in out<br>
          xnested1 in int 0 attenuator<br>
          xnested2 int out 0 attenuator<br>
          .ends<br>
          <p>To use subcircuit bigatten, insert the following line in the netlist:
          <p class="showcode">xexample2 7 8 bigatten
          <p>The depth of nested subcircuits (like the one above) is not limited. 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="3"></a>
          Subcircuit Name Expansion
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          In order to refer to internal nodes, devices and models inside subcircuits you must know 
          how the names are expanded before the netlist is parsed. What is subcircuit expansion? 
          Before SPICE actually parses the circuit, it makes two passes through the netlist. During 
          the first pass subcircuit definitions are collected. During second pass SPICE actually 
          replaces each subcircuit reference ('x' element) with the actual subcircuit. This is not 
          as trivial as it may seem. Generally two things need to be done:
          <ul class="noindent">
          <li>Replace subcircuit nodes that represent its interface with the nodes specified in 
          the subcircuit instance call (X line).
          <li>Rename all internal subcircuit nodes, devices and models so name conflicts can't occur. 
          Subsequently all references to these nodes, devices and models inside the 
          subcircuit must also be renamed
          </ul>
          <p>Let's explain this using an exemplar circuit:
          <p class="showcode">v1 int1 0 1<br>
          rin int1 1 50<br>
          xsub1 1 2 100 attenuator<br>
          xsub2 2 3 100 attenuator<br>
          xsub3 3 4 bigatten<br>
          rx1 100 0 1m<br>
          rout 4 0 50<br>
          <p>This netlist expands to:
          <p class="showcode">v1 int1 0 1<br>
          rin int1 1 50
          <p>This is the expansion of subcircuit instance xsub1 (attenuator):
          <p class="showcode">r1:xsub1 1 int:xsub1 16.67 rmod1:xsub1<br>
          r2:xsub1 int:xsub1 2 16.67 rmod1:xsub1<br>
          r3:xsub1 int:xsub1 100 66.67 rmod1:xsub1<br>
          .model rmod1:xsub1 r tc1=0.001 tc2=0.0001<br>
          <p>This is the expansion of subcircuit instance xsub2 (attenuator):
          <p class="showcode">r1:xsub2 2 int:xsub2 16.67 rmod1:xsub2<br>
          r2:xsub2 int:xsub2 3 16.67 rmod1:xsub2<br>
          r3:xsub2 int:xsub2 100 66.67 rmod1:xsub2<br>
          .model rmod1:xsub2 r tc1=0.001 tc2=0.0001<br>
          <p>And now the expansion of subcircuit instance xsub3 (bigatten).
          First the expansion of nested subcircuit xnested1 in xsub3 (attenuator):
          <p class="showcode">r1:xnested1:xsub3 3 int:xnested1:xsub3 16.67 rmod1:xnested1:xsub3
          <br>r2:xnested1:xsub3 int:xnested1:xsub3 int:xsub3 16.67 rmod1:xnested1:xsub3
          <br>r3:xnested1:xsub3 int:xnested1:xsub3 0 66.67 rmod1:xnested1:xsub3
          <br>.model rmod1:xnested1:xsub3 r tc1=0.001 tc2=0.0001
          <p>The expansion of nested subcircuit xnested2 in xsub3 (attenuator):
          <p class="showcode">r1:xnested2:xsub3 int:xsub3 int:xnested2:xsub3 16.67 rmod1:xnested2:xsub3
          <br>r2:xnested2:xsub3 int:xnested2:xsub3 4 16.67 rmod1:xnested2:xsub3
          <br>r3:xnested2:xsub3 int:xnested2:xsub3 0 66.67 rmod1:xnested2:xsub3
          <br>.model rmod1:xnested2:xsub3 r tc1=0.001 tc2=0.0001
          <p>And finally the last two resistances from the original netlist.
          <p class="showcode">rx1 100 0 1m
          <br>rout 4 0 50
          <p>Full instance name consists of a device letter and the rest of the instance name. An example 
          is rin10: r is the device letter telling the parser that it is dealing with a resistor and in10 
          is the rest of the instance name. Another example is xinner1: x is the device letter that tells 
          the parser it is dealing with a subcircuit and inner1 is the rest of the subcircuit instance name.
					<p class="content-title-noshade-size2">Expansion rules<p>
          For node names:
          <p class="showcode">node_name:lowest_level_full_subcircuit_instance_name:....
          <p>Example:
          <p class="showcode">int:xnested1:xsub3
          <p>This means: node int inside subcircuit instance xnested1 that resides inside subcircuit instance xsub3.
          <p>For instance names:
          <p class="showcode">full_device_instance_name:lowest_level_full_subcircuit_instance_name:....
          <p>Example:
          <p class="showcode">r1:xnested1:xsub3
          <p>This means: resistor instance r1 (instance name 1) inside subcircuit instance xnested1 that resides inside subcircuit instance xsub3.
          <p>For model names:
          <p class="showcode">model_name:lowest_level_full_subcircuit_instance_name:....
          <p>Example:
          <p class="showcode">rmod1:xnested2:xsub3
          <p>This means: model named rmod1 inside subcircuit instance xnested2 that resides inside subcircuit instance xsub3.
          <p>Let's say you want to plot the voltage of internal subcircuit node int that resides inside subcircuit instance xnested1 
          that resides inside subcircuit instance xsub3. Simply type:
          <p class="showcode">plot v(int:xnested1:xsub3)
          <p>To alter the resistance instance parameter to 20 for resistor r3 inside subcircuit instance xnested1 
          that resides inside subcircuit instance xsub3 type:
          <p class="showcode">let @r3:xnested1:xsub3[resistance]=20
          <p>To alter the tc1 model parameter to 0.002 for model rmod1 inside subcircuit instance xnested1 that resides 
          inside subcircuit instance xsub3 type:
          <p class="showcode">let @@rmod1:xnested1:xsub3[tc1]=0.002 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="4"></a>
          Global Nodes (.GLOBAL)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          In version 2.02 .global HSPICE option was introduced. This option makes certain nodes global thus 
          preventing their expansion when they are found in subcircuits. Ground node (0) is global by default. 
          To make nodes global, enter the following option in your netlist:
          <p class="showcode">.global node1 [node2 [node3 ...]]
          <p>To make nodes vdd and vss global enter the following option in your netlist:
          <p class="showcode">.global vss vdd
          <p>Now all nodes named vdd and vss are no longer expanded when they are inside subcircuits.
          This enables you to make connections to subcircuits without stating any connection interface nodes 
          in a subcircuit definition. In a sense this is similar to global variables in C. 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="4x1"></a>
          Local and global .model definitions (v2.1)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          A model defined inside a subcircuit is a local model. Such a model can only be accessed inside that subcircuit.
          A model defined outside a subcircuit is a global model. Such a model can be accessed in the top level circuit 
          and in all subcircuit. If a local model has the same name as the global model, the local model is used. 
          Smells like C... 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="4x2"></a>
          Instance and node lookup for CMs, controlled sources (B, E, F, G, H, POLY) and K elements (v2.1)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          In case any of the above mentioned netlist elements or models is used inside a subcircuit definition 
          all instance names are expanded. This makes all references of other instances inside a subcircuit 
          definition local:
          <p class="showcode">* K1 references instances (L1 and L2) inside the subcircuit (local instances)
          <br>.SUBCKT ...
          <br>...
          <br>K1 L1 L1 0.99
          <br>...
          <br>.ENDS 
          <p>Same goes for nodes. Node names are also expanded and translated which makes them local unless 
          they appear in the subcircuit connection list or they are global. A subcircuit connection is the 
          only way beside global nodes to send a signal into a subcircuit. 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="5"></a>
          Parametrized Subcircuits (v2.1)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          A subcircuit can be parametrized by defining it in the following manner:
          <p class="showcode">.subckt subckt_name node1 node2 ... 
          <br>+ noden [Param:] param1=def1 param2=def2 ... paramm=defm
          <br>subckt netlist
          <br>.ends
          <p>Where defi is the default value for parameter parami. The default value can be ommited. 
          In the latter case the parameter value must be specified at the subcircuit instantiation.
          Default values can be real or complex scalars or vectors. The syntax is the same as in Nutmeg.
          Example:
          <p class="showcode">* a is a real scalar
          <br>* b is a complex scalar
          <br>* c is a real vector
          <br>* d is a complex vector
          <br>* e is a parameter with no default value
          <br>.subckt demosub 1 2 3 Param: a=1 b=(1,2) c=(1;2;3) d=((1,2);(3,4)) e
          <br>...
          <br>.ends
          <p>The Param: keyword can be ommited. In case it is ommited, the first parameter 
          (param1) must have a default value otherwise it will be interpreted as one of the 
          connection nodes of the subcircuit. In case the Param: keyword, parameter names and their 
          defaults are ommited the subcircuit is parameterless and acts like an ordinary SPICE 
          subcircuit. A parametrized subcircuit can be instantiated in your netlist in the 
          following manner:
          <p class="showcode">x1 conn1 conn2 ... connn subckt_name [Param:] param1=val1 param2=val2 ... paramm=valm
          <p>The Param: keyword can be ommited. The parameter along with its value can be ommited. If a parameter 
          is not specified at instantiation, the default value is used. If no default value is found, 
          an error occurs. Example:
          <p class="showcode">* For b and d the default values are used
          <br>x1 10 20 30 demosub Param: a=10 c=2 e=1
          <p>In case the Param: keyword, parameters and their values are ommited, the default values are used 
          for all parameters. If any default is missing at subcircuit definition an error occurs. To parametrize 
          an instance or model parameter value use the {expression} syntax. Let's define a voltage divider 
          with a variable ratio:
          <p class="showcode">.subckt divider top out bottom Param: ratio=0.5 rtotal=10k
          <br>r1 top out {(1-ratio)*rtotal}
          <br>r2 out bottom {ratio*rtotal}
          <br>.ends
          <p>To instantiate a voltage divider with ratio 0.25 and total resistance 100k use:
          <p class="showcode">x1 pow out 0 divider Param: ratio=0.25 rtotal=100k
          <p>One can also parametrize subcircuit instances inside a subcircuit definition:
          <p class="showcode">.subckt bigsub top out1 out2 bottom Param: ratio1=0.25 ratio2=0.5 rtotal=100k
          <br>x1 top out1 bottom Param: ratio={ratio1/2} rtotal={rtotal}
          <br>x2 top out2 bottom Param: ratio={ratio2/2} rtotal={rtotal}
          <br>.ends
          <p>Curly braces can be ommited when passing expression values to subcircuit instances:
          <p class="showcode">.subckt bigsub top out1 out2 bottom Param: ratio1=0.25 ratio2=0.5 rtotal=100k
          <br>x1 top out1 bottom Param: ratio=ratio1/2 rtotal=rtotal
          <br>x2 top out2 bottom Param: ratio=ratio2/2 rtotal=rtotal
          <br>.ends
          <p>Note that the latter is allowed with subcircuit instances only (not with SPICE devices). The following example is wrong:
          <p class="showcode">.subckt divider top out bottom Param: ratio=0.5 rtotal=10k
          <br>r1 top out (1-ratio)*rtotal
          <br>r2 out bottom ratio*rtotal
          <br>.ends
          <p>In case curly braces are ommited, use the 'eq' operator instead of '='. Any valid Nutmeg operator, function 
          or constant from the const plot can be used in an expression. Avoid using the '=' operator since it causes 
          problems in some special cases. Use 'eq' instead. Models can also be parametrized:
          <p class="showcode">.subckt divider top out bottom Param: ratio=0.5 rtotal=10k tc=0
          <br>r1 top out {(1-ratio)*rtotal} rmod
          <br>r2 out bottom {ratio*rtotal} rmod
          <br>.model rmod r tc1={tc}
          <br>.ends
          <p>A B-source can also be parametrized:
          <p class="showcode">* A multiplier
          <br>.subckt mult in1 in2 out Param: offset=0 factor=1
          <br>B1 out 0 V=({offset})+({factor})*v(in1)*v(in2)
          <br>.ends
          <br>* Another example
          <br>* A sigmoid transfer function
          <br>.subckt sigmoid in out Param: offset=0 span=2 steepness=1
          <br>* Note that constant PI is taken form the const plot because {pi} is used
          <br>B1 out 0 V=({offset})+({span/pi})*atan(v(in))*({pi/2*steepness}))
          <br>.ends
          <p>Note that {} expressions are surrounded by a second set of ordinary brackets (). This prevents errors if 
          an {} expression expands to a negative number. 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="6"></a>
          The .PARAM Clause (v2.1)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          Syntax:
          <p class="showcode">.PARAM parameter=expression
          <p>Additional parameters can be defined using the .PARAM clause. These parameters are 
          evaluated after the parameters are passed to the subcircuit but prior to any element or 
          model instantiations. It doesn't matter where in the subcircuit definition the .PARAM clause 
          is located. It is always evaluated prior to any instance/model parsing. .PARAM clauses 
          are evaluated in the same order as they are found in the subcircuit definition.
          Example:
          <p class="showcode">.subckt divider top out bottom Param: ratio=0.5 rtotal=10k tc=0
          <br>.param r1=(ratio-1)*rtotal
          <br>.param r2=ratio*rtotal
          <br>r1 top out {r1} rmod
          <br>r2 out bottom {r2} rmod
          <br>.model rmod r tc1={tc}
          <br>.ends
          <p>This is also possible (results in the same subcircuit as the previous definition):
          <p class="showcode">.subckt divider top out bottom Param: ratio=0.5 rtotal=10k tc=0
          <br>.param r2=ratio*rtotal
          <br>* A previously defined parameter is used in the expression
          <br>.param r1=rtotal-r2
          <br>r1 top out {r1} rmod
          <br>r2 out bottom {r2} rmod
          <br>.model rmod r tc1={tc}
          <br>.ends
          <p>Avoid recursion when using .PARAM:
          <p class="showcode">* This should be avoided
          <br>.subckt 1 2 rhalved Param: a
          <br>.param a=a/2
          <br>r1 1 2 {a}
          <br>.ends<br>
          <br>* This is better
          <br>.subckt 1 2 rhalved Param: a
          <br>.param tmpa=a/2
          <br>r1 1 2 {tmpa}
          <br>.ends
          <p>.PARAM defines a global parameter if it is used outside a subcircuit definition. 
          A global parameter is accessible in all parametrized expressions inside or outside 
          subcircuit definitions.
          <p class="showcode">* Define some globals
          <br>.param con1=2
          <br>.subckt 1 2 rhalved Param: a
          <br>.param tmpa=a/con1
          <br>r1 1 2 {tmpa}
          <br>.ends
          <br>* Global parameters can also be used in the top level circuit
          <br>* 5k resistor
          <br>rtop 1 0 {10k/con1}
          <br>* This is also legal, 10k is passed as the value of a
          <br>x1 5 0 rhalved Param: a=20k/con1
          <p>If a subcircuit parameter with the same name as the global parameter is defined, the local 
          parameter value is used. The global parameter is left unchanged:
          <p class="showcode">* Define some globals
          <br>.param con1=2
          <br>.subckt 1 2 rhalved1 Param: a
          <br>.param con1=3
          <br>* 3 is used for con1 inside rhalved1, global con1 value is left unchanged
          <br>.param tmpa=a/con1
          <br>r1 1 2 {tmpa}
          <br>.ends
          <br>* con1 is global here (2 is used, resulting in 5k)
          <br>r1 9 0 {10k/con1}<br>
          <br>* Another example
          <br>.param con1=5
          <br>* con1 inside rhalved2 is also local.
          <br>* This time it is passed as a parameter to rhalved2 with 2 for default).
          <br>.subckt 1 2 rhalved2 Param: a con1=2
          <br>.param tmpa=a/con1
          <br>r1 1 2 {tmpa}
          <br>.ends
          <br>* con1 is global here (5 is used, resulting in 4k)
          <br>r1 9 0 {20k/con1}
          <p>Yes, default value can also be specified as an expression. Remember not to put curly braces 
          around the expression! A global parameter can be used in an expression as long as the global 
          parameter is defined before the subcircuit definition:
          <p class="showcode">* Define some globals (con1 = 6.28...)
          <br>* pi is found in the const plot
          <br>.param con1=2*pi
          <br>* Default for a is 5k/pi
          <br>* No curly braces are used for default expression!
          <br>.subckt 1 2 rfac Param: a=10k/con1
          <br>.param tmpa=a/con1
          <br>r1 1 2 {tmpa}
          <br>.ends
          <p>This is legal too. Don't use curly braces for the default value expression:
          <p class="showcode">* No curly braces are used for default expression!
          <br>* a defaults to 5k
          <br>.subckt 1 2 rfac Param: a=10k/2 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="5x"></a>
          Parameter Expansion (v2.1)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          Parametrized subcircuits work by means of parameter expansion. The trick is that for the built-in 
          SPICE devices and XSPICE CMs the value of the expression in the curly braces gets converted 
          to the format required by the respective device/model line. All parameters are Nutmeg vectors which 
          means they can be real or complex with an arbitrary number of components. No type checking is 
          performed. You have to make sure that the line makes sense (e.g. the result of an expression 
          must be a real scalar for a real scalar device/model parameter). Let's take a look at an example 
          which clarifies this:
          <p class="showcode">* A real scalar
          <br>.param rscal=9
          <br>* A complex scalar
          <br>.param cscal=(1,9)
          <br>* A real vector (1.0;2.0)
          <br>.param rvec=(1;2)
          <br>* A complex vector ((1,0);(1,2))
          <br>* Note that (1,0)==1
          <br>.param cvec=(1;(1,2))
          <br>* Now let's see how this works in a SPICE device/model<br>
          <br>V1 1 2 0 PULSE {rscal} 2 0.1m 1u 1u
          <br>* ^^^^ expands to: V1 1 2 0 PULSE 9 2 0.1m 1u 1u
          <br>* {rscal} expands to '9'<br>
          <br>V2 2 3 0 PULSE {cscal} 0.1m 1u 1u
          <br>* ^^^^ expands to: V2 2 3 0 PULSE 1 9 0.1m 1u 1u
          <br>* {cscal} expands to '1 9'<br>
          <br>V3 4 5 0 PULSE {rvec} 0.1m 1u 1u
          <br>* ^^^^ expands to: V3 4 5 0 PULSE 1 2 0.1m 1u 1u
          <br>* {rvec} expands to '1 2'<br>
          <br>V4 5 6 0 PULSE {cvec} 10 10
          <br>* ^^^^ expands to: V4 5 6 0 PULSE 1 0 1 2 10 10
          <br>* {cvec} expands to '1 0 1 2'
          <p>To summarize the rules for expressions in built-in SPICE models:
          <p class="showcode">{real scalar} -> value
          <br>{complex scalar} -> rvalue ivalue
          <br>{real vector} -> value1 value2 ...
          <br>{complex vector} -> rvalue1 ivalue1 rvalue2 ivalue2 ...
          <p>The rules for XSPICE code models are somewhat different (different syntax):
          <p class="showcode">{real scalar} -> value
          <br>{complex scalar} -> &lt;rvalue,ivalue&gt;
          <br>{real vector} -> [value1 value2 ... ]
          <br>{complex vector} -> {&lt; rvalue1 ivalue1 &gt; &lt; rvalue2 ivalue2 &gt; ... ]
          <p>Example:
          <p class="showcode">.param rvec=(1;1;0)
          <br>.model cm1 some_code_model real_vector={rvec}
          <br>* ^^^^ expands to: .model cm1 some_code_model real_vector=[1 1 0]
          <br>* {rvec} expands to '[1 1 0]'
          <p>Remember. No type checking is done so in case you specify an expression that results in a vector 
          where one should use a scalar, the parser will report an error and refuse to parse the circuit. 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="7"></a>
          Listing The Circuit, Global Nodes, Subcircuit Definitions And Subcircuit Instances (v2.1)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          A circuit consists of modules (subcircuit instances). One module is always present. That is the 
          top level circuit (named xtopinst_). Its definition is named topdef_. There is always only one 
          xtopinst_ module. The top level circuit and other modules may comprise multiple sub-modules (sub circuit 
          instances). Modules (subcircuit instances) can be nested. Definitions cannot be nested (i.e. one c
          annot define a subcircuit inside a subcircuit definition).
          Consider the following netlist:
          <p class="showcode">TESTNET<br>
          <br>.param testp1=100
          <br>.param testp2=testp1*9
          <br>* Complex vector (1,0);(2,0);(3,1)
          <br>.param vec1=(1;2;(3,1))
          <br>* Real vector 1;2;3
          <br>.param vec2=(1;2;3)<br>
          <br>.global vss vdd<br>
          <br>.subckt test1 1 2 3
          <br>r1 1 2 1
          <br>r2 2 3 1
          <br>.ends<br>
          <br>.subckt test 1 2 3 param: a=5*testp2 b c=vec1 d=9 e f=vec2 g
          <br>.param hello = 1
          <br>.param aw = 2
          <br>.param u=5
          <br>r1 1 2 1
          <br>r2 2 3 1
          <br>.ends<br>
          <br>xtestsub 50 60 0 test param: b=1 e=vec1 d=1 g=1<br>
          <br>.subckt tcres n1 n2 param: r tc1=0 tc2=0 temp=27 tnom=27
          <br>r1 n1 n2 {r} rm temp={temp}
          <br>.model rm r tc1={tc1} tc2={tc2} tnom={tnom}
          <br>.ends<br>
          <br>.subckt vdiv up down out param: k=0.5 r=1k
          <br>.param upr=r*(1-k)
          <br>.param dnr=r*k
          <br>.param tclin=0.01
          <br>x1 up out tcres param: r=upr tc1=tclin
          <br>x2 out down tcres param: r=dnr tc1=tclin*2
          <br>.ends<br>
          <br>xdiv 1 0 out vdiv param: k=0.25 r={10k*testp1}<br>
          <br>rtop 10 0 1<br>
          <br>.control
          <br>echo hello
          <br>.endc<br>
          <br>.end
          <p>The top level circuit (xtopinst_) consists of resistor instance rtop and modules xdiv and 
          xtestsub. The definition of xtopinst_ is topdef_. The definition of xdiv is vdiv and the definition 
          of xtestsub is test. xdiv comprises modules x1:xdiv and x2:xdiv. The definition of x1:xdiv and x2:xdiv 
          is tcres. x1:xdiv and x2:xdiv both consist of a resistor instance (r1:x1:xdiv, r1:x2:xdiv) and a 
          resistor model (rmod:x1:xdiv, rmod:x2:xdiv). The following commands are available for getting 
          information on the active circuit's netlist:
          <p class="showcode">listing
          <p>or
          <p class="showcode">listing logical
          <p>The latter two commands display the netlist along with line numbers. The .control block is ommited.
          <p class="showcode">listing physical
          <p>Displays the physical listing (all lines from input file(s) including the .control block 
          and empty lines) with line numbers.
          <p class="showcode">listing deck
          <p>Same as previous except that line numbers are ommited.
          <p class="showcode">listing global
          <p>Displays all global nodes. For the TESTNET netlist the result is:
          <p class="showcode">SpiceOpus (c) 19 -> listing global
          <br>Global nodes: vss vdd<br>
          <br>listing subdef
          <p>Displays a list of all subcircuit definitions. For the TESTNET listing it displays:
          <p class="showcode">SpiceOpus (c) 21 -> listing subdef
          <br>Active subcircuit definitions:
          <br>vdiv
          <br>tcres
          <br>test
          <br>test1
          <br>topdef_
          <br>----
          <p>topdef_ is the top level circuit definition.
          <p class="showcode">listing subdef name1 name2 ...
          <p>Displays the information on listed subcircuit definitions. Example:
          <p class="showcode">SpiceOpus (c) 24 -> listing subdef topdef_ tcres vdiv
          <br>Instances of topdef_ :
            <br>xtopinst_<br>
          <br>Definition of topdef_ :
            <br>Terminals:
          <br>--none--
          <br>Parameters:
          <br>--none--
          <br>Parametric expressions:
          <br>testp1 = 100
          <br>testp2 = testp1*9
          <br>vec1 = (1;2;(3,1))
          <br>vec2 = (1;2;3)
          <br>Elements:
          <br>xtestsub 50 60 0 test param: b=1 e=vec1 d=1 g=1
          <br>xdiv 1 0 out vdiv param: k=0.25 r={10k*testp1}
          <br>rtop 10 0 1
          <br>----
          <br>Instances of tcres :
          <br>  x2:xdiv
          <br>  x1:xdiv<br>
          <br>Definition of tcres :
          <br>  Terminals:
          <br>n1 n2
          <br>Parameters:
          <br>r
          <br>tc1 = 0
          <br>tc2 = 0
          <br>temp = 27
          <br>tnom = 27
          <br>Parametric expressions:
          <br>--none--
          <br>Elements:
          <br>r1 n1 n2 {r} rm temp={temp}
          <br>.model rm r tc1={tc1} tc2={tc2} tnom={tnom}
          <br>Instances of vdiv :
          <br>xdiv<br>
          <br>Definition of vdiv :
          <br>Terminals:
          <br>up down out
          <br>Parameters:
          <br>k = 0.5
          <br>r = 1000
          <br>Parametric expressions:
          <br>upr = r*(1-k)
          <br>dnr = r*k
          <br> tclin = 0.01
          <br>Elements:
          <br>x1 up out tcres param: r=upr tc1=tclin
          <br>x2 out down tcres param: r=dnr tc1=tclin*2
          <br>----
          <p>For every subcircuit definition the list of instances is printed along with the 
          terminals, parameters, default values, parametric expressions (.PARAM clauses) 
          and list of elements.
          <p class="showcode">listing sub
          <p>Displays the list of all instances sorted by their respective subcircuit definitions. Example:
          <p class="showcode">SpiceOpus (c) 25 -> listing sub
          <br>Subcircuit instances of vdiv:
          <br>xdiv<br>
          <br>Subcircuit instances of tcres:
          <br>x2:xdiv
          <br>x1:xdiv<br>
          <br>Subcircuit instances of test:
          <br>xtestsub<br>
          <br>Subcircuit instances of test1:
          <br>--none--<br>
          <br>Subcircuit instances of topdef_:
          <br>xtopinst_<br>
          <br>listing sub name1 name2 ...
          <p>Displays information on listed subcircuit instances. Example:
          <p class="showcode">SpiceOpus (c) 31 -> listing sub xtopinst_ xtestsub xdiv x2:xdiv<br>
          <br>Subcircuit instance xtopinst_ :
          <br>Definition : topdef_
          <br>Instantiated in top level circuit
          <br>Connections (model -> instance) :
          <br> --none--
          <br>Parameters :
          <br>--none--
          <br>----<br>
          <br>Subcircuit instance xtestsub :
          <br>Definition : test
          <br>Instantiated in top level circuit
          <br>Connections (model -> instance) :
          <br>1 -> 50
          <br>2 -> 60
          <br>3 -> 0
          <br>Parameters :
          <br>a = (dfl) 4500
          <br>b = 1
          <br>c = (dfl) ((1,0);(2,0);(3,1))
          <br>d = 1
          <br>e = ((1,0);(2,0);(3,1))
          <br>f = (dfl) (1;2;3)
          <br>g = 1
          <br>----<br>
          <br>Subcircuit instance xdiv :
          <br>Definition : vdiv
          <br>Instantiated in top level circuit
          <br>Connections (model -> instance) :
          <br>up -> 1
          <br>down -> 0
          <br>out -> out
          <br>Parameters :
          <br>k = 0.25
          <br>r = 1e+006
          <br>----<br>
          <br>Subcircuit instance x2:xdiv :
          <br>Definition : tcres
          <br>Instantiated in xdiv
          <br>Connections (model -> instance) :
          <br>n1 -> out
          <br>n2 -> 0
          <br>Parameters :
          <br>r = 250000
          <br>tc1 = 0.02
          <br>tc2 = (dfl) 0
          <br>temp = (dfl) 27
          <br>tnom = (dfl) 27
          <br>----
          <p>For each instance the name of the definition is printed along with the place where it is 
          instantiated, connections and parameters. If a parameter is set to the default (ommited at 
          subcircuit call) (dfl) is printed in front of the value.
          There is always one top level subcircuit (topdef_) instance named xtopinst_. 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="8"></a>
					Altering/reading subcircuit parameters from Nutmeg (v2.1)
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          To access a subcircuit parameter from Nutmeg use the following syntax:
          <p class="showcode">@xname[parameter]
          <p>Examples:
          <p class="showcode">* Prints the a parameter for subcircuit instance x1:xamp1
          <br>print @x1:xamp1[a]<br>
          <br>* Sets the a parameter for subcircuit instance x1:xamp1 to 10
          <br>let @x1:xamp1[a]=10
          <p>All instances/models/subcircuits in the subcircuit instance for which the parameter is 
          altered are reparsed and affected parameters recalculated.
          To alter a particular parameter for all instances of some subcircuit use
          <p class="showcode">@@submod[a]
          <p>This way you can alter parameter a for all instances of subcircuit submod. Parameter 
          a must be given a default value in the subcircuit definition. Examples:
          <p class="showcode">* Prints the default value of the a parameter for subcircuit definition ampmod
          <br>print @@ampmod[a]<br>
          <br>* Sets the a parameter to 10 for all subcircuit instances of ampmod
          <br>let @@ampmod[a]=10
          <p>All instances/models/subcircuits in the subcircuit instance for which the parameter is 
          altered are reparsed and affected parameters recalculated. 
          </p></div>
        </div>
      </div> 

      
			<!-- Text container -->
			<div class="content2-container line-box">
				<div class="content2-container-1col">				
					<p class="content-title-noshade-size3">
					<a name="binning"></a>
					Automatic model selection (binning) for BSIM3v3 MOSFET device model
          </p>                            
					<div class="content-txtbox-noshade"><p>      
          BSIM3v3 and BSIM4 MOSFET (level = 53 and 54) device models are usually valid only for a 
          specified range of transistor channel widths and lengths. Valid range is given by lmin, 
          lmax, wmin and wmax model parameters and instance's width and length are given by its w 
          and l parameters. Consequently relations  lmin <  l <  lmax and  wmin <  w <  wmax should 
          hold. In general if channel is changed outside specified w,l range another model covering 
          new dimensions should be selected. To get continuous passages on borders between different 
          width and length ranges binning technique is used (defined by binning model parameters).
          Model names have the following syntax:
          <p class="showcode">&lt;model_name&gt;_&lt;bin_name&gt;
          <p>bin_name can be omitted in transistor instance line. SpiceOpus searches among models with 
          the same model name and different bin names. The right model will be automatically selected.
          Example (level = 53 or 54):
          <p class="showcode">...
          <br>m1 drain gate source bulk nmod l=4um w=120um ...
          <br>...
          <br>.model nmod_1 nmos level=5x lmin=1u lmax=5u wmin=1u wmax=100u ...
          <br>.model nmod_2 nmos level=5x lmin=5u lmax=10u wmin=1u wmax=100u ...
          <br>.model nmod_3 nmos level=5x lmin=1u lmax=5u wmin=100u wmax=250u ...
          <br>.model nmod_4 nmos level=5x lmin=5u lmax=10u wmin=100u wmax=250u ...
          <br>...
          <p>In the above example model mod_3 will be selected for instance m1.
          If wrong bin_name is given in the transistor instance line then the right bin will 
          be automatically selected. Example (level = 53 or 54):
          <p class="showcode">m1 drain gate source bulk nmod_1 l=4um w=120um ...
          <br>...
          <br>.model nmod_1 nmos level=5x lmin=1u lmax=5u wmin=1u wmax=100u ...
          <br>.model nmod_2 nmos level=5x lmin=5u lmax=10u wmin=1u wmax=100u ...
          <br>.model nmod_3 nmos level=5x lmin=1u lmax=5u wmin=100u wmax=250u ...
          <br>.model nmod_4 nmos level=5x lmin=5u lmax=10u wmin=100u wmax=250u ...
          <br>...
          <p>In the above example model mod_3 will be selected for instance m1, regardless 
          that mod_1 was specified. If instance's channel width and length do not fit into any of 
          the specified model bins, then the nearest bin will be selected.
          </p></div>
        </div>
      </div> 

      



		
		
     
     </div>

    <!-- FOOTER -->
    <div class="footer">
       <p><b>Copyright &copy; 2008 Faculty of Electrical Engineering, Ljubljana, Slovenia | All Rights Reserved</b></p>
       <p>Page Design <a href="mailto:gw@actamail.com">G. Wolfgang</a> | Page content <a href="mailto:spice_developers@fides.fe.uni-lj.si">EDA Group</a></p>
    </div>
  </div>
  

 <script type="text/javascript">
   var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
   document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
 </script>
 <script type="text/javascript">
   try
   {
     var pageTracker = _gat._getTracker("UA-8305434-3");
     pageTracker._trackPageview();
   } catch(err)
   {
   }
 </script>
  
  
</body>
</html>